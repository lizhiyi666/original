/opt/conda/envs/marionette/lib/python3.10/site-packages/lightning_fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
[Baseline3] existence_weight 20.0
[Baseline3] Classifier-Based Guidance enabled
[Baseline3] scale=50000000.0, temp=1.0, last_k=100, freq=1
[GPU 3] Processing 1195 sequences (Range: 3594 -> 4789)
po_matrix shape: torch.Size([512, 9, 9]) sum0: 26.0
tau before cond_encoder: torch.Size([512, 15]) time: torch.Size([512, 15])
tau after  cond_encoder: torch.Size([512, 15]) time: torch.Size([512, 15])
[Baseline3-Debug] category_mask.shape=(512, 31), category_mask.sum=3059
[Baseline3-Debug] cat_grad on mask: norm=0.132762, min=-0.062094, max=0.048821
[Baseline3-Debug] full grad: norm=0.156439, cat_part_norm=0.156439
[Baseline3-Guidance] step=99, energy_soft=255149.2188, hard_viol_before=498.4213, hard_viol_after=447.9616, raw_grad_norm=0.156439, scale=50000000.0, temp=1.0
[DEBUG][shape] time torch.Size([512, 15])
[DEBUG][shape] mask torch.Size([512, 15])
[DEBUG][shape] tau  torch.Size([512, 15])
[DEBUG][shape] cond1 torch.Size([512, 15])
[DEBUG][shape] unpadded_length torch.Size([512]) 14
[DEBUG][shape] content_token torch.Size([512, 31])
po_matrix shape: torch.Size([512, 9, 9]) sum0: 20.0
tau before cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
tau after  cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
[DEBUG][shape] time torch.Size([512, 14])
[DEBUG][shape] mask torch.Size([512, 14])
[DEBUG][shape] tau  torch.Size([512, 14])
[DEBUG][shape] cond1 torch.Size([512, 14])
[DEBUG][shape] unpadded_length torch.Size([512]) 13
[DEBUG][shape] content_token torch.Size([512, 29])
po_matrix shape: torch.Size([171, 9, 9]) sum0: 18.0
tau before cond_encoder: torch.Size([171, 11]) time: torch.Size([171, 11])
tau after  cond_encoder: torch.Size([171, 11]) time: torch.Size([171, 11])
[DEBUG][shape] time torch.Size([171, 11])
[DEBUG][shape] mask torch.Size([171, 11])
[DEBUG][shape] tau  torch.Size([171, 11])
[DEBUG][shape] cond1 torch.Size([171, 11])
[DEBUG][shape] unpadded_length torch.Size([171]) 10
[DEBUG][shape] content_token torch.Size([171, 23])
[GPU 3] Saved part file to ./data/Istanbul_PO1/Istanbul_PO1_ihfzzq9m_generated_part3.pkl
