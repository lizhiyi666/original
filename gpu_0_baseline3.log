/opt/conda/envs/marionette/lib/python3.10/site-packages/lightning_fabric/__init__.py:29: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  __import__("pkg_resources").declare_namespace(__name__)
[Baseline3] existence_weight 20.0
[Baseline3] Classifier-Based Guidance enabled
[Baseline3] scale=50000000.0, temp=1.0, last_k=100, freq=1
[GPU 0] Processing 1198 sequences (Range: 0 -> 1198)
po_matrix shape: torch.Size([512, 9, 9]) sum0: 25.0
tau before cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
tau after  cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
[Baseline3-Debug] category_mask.shape=(512, 29), category_mask.sum=3040
[Baseline3-Debug] cat_grad on mask: norm=0.213572, min=-0.108799, max=0.110070
[Baseline3-Debug] full grad: norm=1.088533, cat_part_norm=1.088533
[Baseline3-Guidance] step=99, energy_soft=255262.5938, hard_viol_before=498.7213, hard_viol_after=469.6678, raw_grad_norm=1.088533, scale=50000000.0, temp=1.0
[DEBUG][shape] time torch.Size([512, 14])
[DEBUG][shape] mask torch.Size([512, 14])
[DEBUG][shape] tau  torch.Size([512, 14])
[DEBUG][shape] cond1 torch.Size([512, 14])
[DEBUG][shape] unpadded_length torch.Size([512]) 13
[DEBUG][shape] content_token torch.Size([512, 29])
po_matrix shape: torch.Size([512, 9, 9]) sum0: 25.0
tau before cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
tau after  cond_encoder: torch.Size([512, 14]) time: torch.Size([512, 14])
[DEBUG][shape] time torch.Size([512, 14])
[DEBUG][shape] mask torch.Size([512, 14])
[DEBUG][shape] tau  torch.Size([512, 14])
[DEBUG][shape] cond1 torch.Size([512, 14])
[DEBUG][shape] unpadded_length torch.Size([512]) 13
[DEBUG][shape] content_token torch.Size([512, 29])
po_matrix shape: torch.Size([174, 9, 9]) sum0: 19.0
tau before cond_encoder: torch.Size([174, 15]) time: torch.Size([174, 15])
tau after  cond_encoder: torch.Size([174, 15]) time: torch.Size([174, 15])
[DEBUG][shape] time torch.Size([174, 15])
[DEBUG][shape] mask torch.Size([174, 15])
[DEBUG][shape] tau  torch.Size([174, 15])
[DEBUG][shape] cond1 torch.Size([174, 15])
[DEBUG][shape] unpadded_length torch.Size([174]) 14
[DEBUG][shape] content_token torch.Size([174, 31])
[GPU 0] Saved part file to ./data/Istanbul_PO1/Istanbul_PO1_ihfzzq9m_generated_part0.pkl
